
<!DOCTYPE html>
<html lang="ja">
<head>
  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet/less" type="text/css" href="http://englishforhackers.com/theme/stylesheet/style.less">
    <script src="//cdnjs.cloudflare.com/ajax/libs/less.js/2.5.1/less.min.js" type="text/javascript"></script>

  <link rel="stylesheet" type="text/css" href="http://englishforhackers.com/theme/pygments/monokai.min.css">
  <link rel="stylesheet" type="text/css" href="http://englishforhackers.com/theme/font-awesome/css/font-awesome.min.css">

    <link href="http://englishforhackers.com/static/custom.css" rel="stylesheet">

    <link href="http://englishforhackers.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="エンジニア・研究者の英語学習 Atom">


    <link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/images/favicon.ico" type="image/x-icon">

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="index, follow" />

    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<meta name="author" content="Masato Hagiwara" />
<meta name="description" content="「無料でアクセスできる最高の強化学習のコース」と名高い、Google DeepMind / University College London の David Silver 氏による強化学習のコース。こちらのページから、全ての講義スライドと講義ビデオが見られる。以下は、講義4 のメモです。 モデルフリー予測 = 未知の MDP の価値関数を推定する モンテカルロ (MC) 学習 経験のエピソードから直接学習する エピソードが終了する必要あり 方策 \( \pi \) の下で、経験のエピソード \( S_1, A_1, R_2, ..., S_k \sim \pi \) から \( v_\pi \) を学習 復習： 利得 \( G_t = R_{t+1} + \gamma R_{t+2} + ... + \gamma …" />
<meta name="keywords" content="">
<meta property="og:site_name" content="エンジニア・研究者の英語学習"/>
<meta property="og:title" content="モデルフリー予測 - Google DeepMind の David Silver 氏による強化学習コース 講義4"/>
<meta property="og:description" content="「無料でアクセスできる最高の強化学習のコース」と名高い、Google DeepMind / University College London の David Silver 氏による強化学習のコース。こちらのページから、全ての講義スライドと講義ビデオが見られる。以下は、講義4 のメモです。 モデルフリー予測 = 未知の MDP の価値関数を推定する モンテカルロ (MC) 学習 経験のエピソードから直接学習する エピソードが終了する必要あり 方策 \( \pi \) の下で、経験のエピソード \( S_1, A_1, R_2, ..., S_k \sim \pi \) から \( v_\pi \) を学習 復習： 利得 \( G_t = R_{t+1} + \gamma R_{t+2} + ... + \gamma …"/>
<meta property="og:locale" content="ja_JP"/>
<meta property="og:url" content="http://englishforhackers.com/david-silver-reinforcement-learning-lecture4.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2018-09-04 00:00:00-04:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="http://englishforhackers.com/author/masato-hagiwara.html">
<meta property="article:section" content="Reinforcement Learning"/>
<meta property="og:image" content="http://masatohagiwara.net/face.jpg">

  <title>モデルフリー予測 - Google DeepMind の David Silver 氏による強化学習コース 講義4 &ndash; エンジニア・研究者の英語学習</title>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-7401771876348738",
      enable_page_level_ads: true
    });
  </script>
</head>
<body>
  <aside>
    <div>
      <a href="http://englishforhackers.com">
        <img src="http://masatohagiwara.net/face.jpg" alt="エンジニア・研究者の<br/>英語学習" title="エンジニア・研究者の<br/>英語学習">
      </a>
      <h1><a href="http://englishforhackers.com">エンジニア・研究者の<br/>英語学習</a></h1>

<p>ソフトウェア・エンジニアや研究者のための英語学習情報。講演/トーク・技術記事・論文などの紹介</p>
      <nav>
        <ul class="list">

          <li><a href="http://masatohagiwara.net/" target="_blank">個人ページ</a></li>
          <li><a href="http://www.duolingo.com/" target="_blank">Duolingo</a></li>
          <li><a href="https://docs.google.com/forms/d/e/1FAIpQLSffbTFvdUXJhN4jTOmylcIRvlntKmaYVkIbYPrbBCPm0iC9Sw/viewform?usp=sf_link" target="_blank">お問い合わせ</a></li>
        </ul>
      </nav>

      <ul class="social">
        <li><a class="sc-github" href="https://github.com/mhagiwara" target="_blank"><i class="fa fa-github"></i></a></li>
        <li><a class="sc-twitter" href="https://twitter.com/mhagiwara" target="_blank"><i class="fa fa-twitter"></i></a></li>
        <li><a class="sc-rss" href="feeds/all.atom.xml" target="_blank"><i class="fa fa-rss"></i></a></li>
      </ul>
    </div>


  </aside>
  <main>

    <nav>
      <a href="http://englishforhackers.com">  Home
</a>

      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>

      <a href="http://englishforhackers.com/feeds/all.atom.xml">  Atom
</a>

    </nav>

<article class="single">
  <header>
    <h1 id="david-silver-reinforcement-learning-lecture4">モデルフリー予測 - Google DeepMind の David Silver 氏による強化学習コース 講義4</h1>
    <p>
        Posted on 2018-09-04(火) in <a href="http://englishforhackers.com/category/reinforcement-learning.html">Reinforcement Learning</a>


    </p>
  </header>


  <div>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

<p>「無料でアクセスできる最高の強化学習のコース」と名高い、Google DeepMind / University College London の David Silver 氏による強化学習のコース。<a href="http://www0.cs.ucl.ac.uk/staff/d.silver/web/Teaching.html">こちらのページから、全ての講義スライドと講義ビデオが見られる</a>。以下は、講義4 のメモです。</p>
<p>モデルフリー予測 = 未知の MDP の価値関数を推定する</p>
<ul>
<li>
<p>モンテカルロ (MC) 学習</p>
<ul>
<li>経験のエピソードから直接学習する</li>
<li>エピソードが終了する必要あり</li>
<li>方策 \( \pi \) の下で、経験のエピソード \( S_1, A_1, R_2, ..., S_k \sim \pi \) から \( v_\pi \) を学習</li>
<li>復習： 利得 \( G_t = R_{t+1} + \gamma R_{t+2} + ... + \gamma^{T-1}R_T \)</li>
<li>復習： 価値関数 \( v_\pi(s) = E_\pi[G_t | S_t = s] \)</li>
<li>モンテカルロ方策評価：各エピソードについて、状態 \( s \) を最初に訪問した時に<ul>
<li>カウンターと利得の合計を更新。</li>
<li>\( V(s) \) → 利得の合計 / 訪問回数</li>
<li>十分多くの \( N(s) \) を観察すると、\( V(s) \) は \( v_\pi(s) \) に収束</li>
</ul>
</li>
<li>各訪問ごとに更新する場合<ul>
<li>訪問回数を、各訪問ごとに更新</li>
<li>これでも、\( V(s) \to v_\pi(s) \)</li>
</ul>
</li>
<li>「差分」を使った系列の平均計算<ul>
<li>系列 \( x_1, x_2, ... \) を全て観測し終わらなくても、それまでの平均 \( \mu_k \) を計算することができる</li>
<li>\( \mu_k = \mu_{k-1} + \frac{1}{k} (x_k - \mu_{k-1}) \) </li>
<li>直感的な説明： 新しい値を観測した時、それまでの推定値と大きくことなる場合は、推定値を大きく更新する。</li>
<li>\( \mu_{k-1} \) →.それまでの推定値。\( x_k - \mu_{k-1} \) → 新しい値を観測した時の「驚き」。\( \frac{1}{k} \) → 学習率</li>
</ul>
</li>
<li>差分モンテカルロ更新<ul>
<li>エピソード毎に更新（全てのエピソードの「和」を保持しない）</li>
<li>\( N(S_t) \leftarrow N(S_t) + 1 \) </li>
<li>\( V(S_t) \leftarrow V(S_t) + \frac{1}{N(S_t)}(G_t - V(S_t)) \)</li>
<li>注：エピソードが終わるまで待つ必要あり</li>
</ul>
</li>
</ul>
</li>
<li>
<p>時間差分 (Temporal Difference) 学習</p>
<ul>
<li>経験のエピソードから直接学習する (モンテカルロ法と同じ)</li>
<li>エピソードが終了してなくても良い → ブートストラップ法 (モンテカルロ法との差異)</li>
<li>MC と TD の違い<ul>
<li>MC: 実際の利得 \( G_t \) を使って更新: \( V(S_t) \leftarrow V(S_t) + \alpha(G_t - V(S_t)) \)</li>
<li>TD: 利得の予測値を使って更新: \( V(S_t) \leftarrow V(S_t) + \alpha(R_{t+1} + \gamma V(S_{t+1}) - V(S_t)) \)<ul>
<li>\( R_{t+1} + \gamma V(S_{t+1}) \) は TD ターゲットと呼ばれる</li>
<li>\( \delta_t = R_{t+1} + \gamma V(S_{t+1}) - V(S_t) \) は TD 誤差と呼ばれる</li>
</ul>
</li>
</ul>
</li>
<li>TD の長所・欠点<ul>
<li>最終結果を見る前に学習できる。最終結果の無いエピソードでも学習できる</li>
<li>偏り (Bias) と分散　(Variance) のトレードオフ<ul>
<li>真の TD ターゲット \( R_{t+1} + \gamma v_\pi(S_{t+1}) \) は \( v_\pi(S_t) \)の 不偏推定量</li>
<li>TD ターケット \( R_{t+1} + \gamma V(S_{t+1}) \) は、偏りのある推定量　</li>
<li>ただし、TD ターゲットは、利得よりも分散が小さい</li>
</ul>
</li>
<li>MC は分散大、偏りゼロ。TD は分散小、偏りあり。</li>
<li>TD(0) は \( v_\pi(s) \) に収束。初期値に敏感</li>
<li>MC は、観察された利得との平均二乗誤差を最小化する解に収束する</li>
<li>TD は、データに対して尤度最大の MDPを学習し、それを解く</li>
</ul>
</li>
<li>ブートストラップとサンプリング<ul>
<li>MC → ブートストラップ無し</li>
<li>DP → ブートストラップ有り</li>
<li>TD → ブートストラップ有り</li>
<li>MC → サンプリング有り</li>
<li>DP → サンプリング無し</li>
<li>TD → サンプリング無し</li>
</ul>
</li>
</ul>
</li>
<li>
<p>TD(λ)</p>
<ul>
<li>TD ターゲットを計算するときに、nステップ先読みする<ul>
<li>例：\( G_t^{(2)}  = R_{t+1} + \gamma R_{t+2} + \gamma^2 V(S_{t+2}) \)</li>
<li>n を大きくすると、MC 法に収束する</li>
</ul>
</li>
<li>nステップ先読みを平均する<ul>
<li>例：\( \frac{1}{2} G_t^{(2)} + \frac{1}{2} G_t^{(4)} \)</li>
</ul>
</li>
<li>γ利得 → 全てのnステップ利得の幾何平均<ul>
<li>\( G_t^\lambda = (1-\lambda) \sum_{n=1}^\infty \lambda^{n-1} G_t^n \)</li>
<li>なぜ幾何平均? 前の値を保持しなくて良いので、計算コストが低い。TD(0) と同じコストで計算できる。</li>
</ul>
</li>
<li>TD(λ) の「前向き」観点<ul>
<li>\( V(S_t) \leftarrow V(S_t) + \alpha (G^\lambda_t - V(S_t)) \)</li>
</ul>
</li>
<li>MC と同じように、エピソードが収束するまで待つ必要がある</li>
<li>TD(λ) の「後ろ向き」観点<ul>
<li>Eligibility Trace<ul>
<li>最近性と、頻度を両方考慮する量</li>
<li>\( E_0(s) = 0, E_t(s) = \gamma E_{t-1}(s) + {\mathbf 1}(S_t = s) \)</li>
</ul>
</li>
<li>\( V(s) \leftarrow V(s) + \alpha \delta_t E_t(s) \)</li>
<li>\( \lambda = 0 \) の時 → TD(0) と等価</li>
<li>\( \lambda = 1 \) の時 → 更新の合計は　MC と同じ</li>
</ul>
</li>
</ul>
</li>
</ul>
  </div>
  <div class="tag-cloud">
    <p>
    </p>
  </div>


    <div class="addthis_relatedposts_inline">


<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'englishforhackers';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
      Please enable JavaScript to view comments.

</noscript>
</article>

    <footer>
<p>
  &copy; Masato Hagiwara 2017 - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>
</p>
<p>  Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by-nc-sa/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
         src="https://i.creativecommons.org/l/by-nc-sa/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p>    </footer>
  </main>

<!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-175204-13', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->



<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " エンジニア・研究者の英語学習 ",
  "url" : "http://englishforhackers.com",
  "image": "http://masatohagiwara.net/face.jpg",
  "description": "ソフトウェア・エンジニアや研究者のための英語学習情報。講演/トーク・技術記事・論文などの紹介"
}
</script>

</body>
</html>